---
layout: post
title: 软中断
date: 2023-09-24 21:31 +0800
categories: [CS_course, OS]
tags: [OS]
mermaid: true
math: true
---

## 1、中断

在计算机中，中断是**系统用来响应硬件设备请求**的一种机制，操作系统收到硬件的中断请求，会打断正在执行的进程，然后调用内核中的中断处理程序来响应请求。

操作系统收到了中断请求，会打断其他进程的运行，所以中断请求的响应程序，也就是中断处理程序，要尽可能快的执行完，这样可以减少对正常进程运行调度地影响。

中断处理程序在响应中断时，可能还会**临时关闭中断**，这意味着，**如果当前中断处理程序没有执行完之前，系统中其他的中断请求都无法被响应**，也就说中断有可能会丢失，所以中断处理程序要短且快。

## 2、软中断

Linux 系统为了**解决中断处理程序执行过长和中断丢失**的问题，将中断过程分成了上半部和下半部分两个阶段。
- 上半部用来快速处理中断，一般会暂时关闭中断请求，主要负责处理跟硬件紧密相关或者时间敏感的事情。
- 下半部用来延迟处理上半部未完成的工作，一般以「内核线程」的方式运行。

中断处理程序的上部分和下半部可以理解为：
- 上半部直接处理硬件请求，也就是硬中断，主要是负责耗时短的工作，特点是快速执行；
- 下半部是由内核触发，也就说软中断，主要是负责上半部未完成的工作，通常都是耗时比较长的事情，特点是延迟执行。

