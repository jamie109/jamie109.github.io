---
layout: post
title: 从输入URL到显示页面
date: 2023-09-27 11:44 +0800
categories: [CS_course, CN]
tags: [computer network]
mermaid: true
math: true
---

## 1、URL解析

根据输入的URL，生成HTTP请求消息。

## 2、DNS

根据服务器域名，得到IP地址。

- 先查缓存：浏览器、OS、hosts。
- 询问根域名服务器（根域名服务器信息保存在所有DNS服务器中）
- 询问顶级域名服务器
- 询问权威域名服务器
  
## 3、TCP

HTTP是基于TCP传输的。

- TCP头：源端口号、目的端口号、序号、确认序号、状态位、窗口大小、校验和等。
- 三次握手，保证双方都可以收发数据。
- 数据部分最大MSS。

## 4、IP

- IP头：源IP、目的IP等。
- IP头+TCP头+数据部分 不能超过 MTU。
- 若存在多个网卡，根据路由表和服务器IP地址确定源IP，找不到就用默认网关0.0.0.0。
  
## 5、MAC

- 接收方MAC、发送方MAC，48位。
- 电脑、路由器都有MAC，交换机没有。发送方的MAC是固定的，接收方MAC就是下一个路由器的MAC，先找缓存，然后ARP 协议（在以太网中以广播的形式，对以太网所有的设备广播）。

## 6、网卡

- 将数字信息转换为电信号，才能在网线上传输。
- 在开头加上报头和起始帧分界符，在末尾加上用于检测错误的帧校验序列FSC。
- 将包转为电信号，通过网线发送出去。

## 7、交换机

- 处于MAC层，无MAC地址。
- 原样转发。
- 根据接收MAC地址将包在某个端口发出去。
- 找不到或者是广播地址，就在除了源端口的所有端口发出去。

## 8、路由器

- 去掉旧MAC。
- 根据目的IP确定要转发的IP，从而确定转发MAC。
- 发送方MAC修改为输出端口的 MAC 地址。
